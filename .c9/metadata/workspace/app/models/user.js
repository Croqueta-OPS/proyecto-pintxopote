{"filter":false,"title":"user.js","tooltip":"/app/models/user.js","undoManager":{"mark":0,"position":0,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":51,"column":52},"action":"insert","lines":["// app/models/user.js","// Llama a los requerimientos, en este caso mongoose y bcrypt","var mongoose = require('mongoose');","//Usamos el módulo bcrypt para almacenar de forma segura una contraseña","var bcrypt   = require('bcrypt-nodejs');","","// Definimos el esquema para el modelo de usuario","var userSchema = mongoose.Schema({","","    local            : {","        nomUsuario   : String,","        email        : String,","        password     : String,","        administrador: String,","        sexo         : String,","        fechaNac     : String","    },","    facebook         : {","        id           : String,","        token        : String,","        email        : String,","        name         : String","    },","    twitter          : {","        id           : String,","        token        : String,","        displayName  : String,","        username     : String","    },","    google           : {","        id           : String,","        token        : String,","        email        : String,","        name         : String","    }","","});","","// metodos ======================","// Generar hash","// Con el Hash creamos un rango de salida finito del password que nos pasan","userSchema.methods.generateHash = function(password) {","    return bcrypt.hashSync(password, bcrypt.genSaltSync(8), null);","};","","// validar el password","userSchema.methods.validPassword = function(password) {","    return bcrypt.compareSync(password, this.local.password);","};","","// crea el modelo para los usuarios y lo exporta para poder usarlo desde cualquier lugar de la app","module.exports = mongoose.model('User', userSchema);"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":12,"column":30},"end":{"row":12,"column":30},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":45,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1420701632000,"hash":"838410e477d247b1f49318e514eac941f400d41e"}