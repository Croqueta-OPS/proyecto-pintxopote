{"filter":false,"title":"routes.js","tooltip":"/app/routes.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":206,"column":11},"end":{"row":206,"column":12},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":12},"end":{"row":206,"column":13},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":13},"end":{"row":206,"column":14},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":14},"end":{"row":206,"column":15},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":15},"end":{"row":206,"column":16},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":16},"end":{"row":206,"column":17},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":17},"end":{"row":206,"column":18},"action":"insert","lines":["/"]},{"start":{"row":206,"column":18},"end":{"row":206,"column":19},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":19},"end":{"row":206,"column":20},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":20},"end":{"row":206,"column":21},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":21},"end":{"row":206,"column":22},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":22},"end":{"row":206,"column":23},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":23},"end":{"row":206,"column":24},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":24},"end":{"row":206,"column":25},"action":"insert","lines":["/"]},{"start":{"row":206,"column":25},"end":{"row":206,"column":26},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":26},"end":{"row":206,"column":27},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":27},"end":{"row":206,"column":28},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":28},"end":{"row":206,"column":29},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":29},"end":{"row":206,"column":30},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":30},"end":{"row":206,"column":31},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":31},"end":{"row":206,"column":32},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":32},"end":{"row":206,"column":33},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":33},"end":{"row":206,"column":34},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":34},"end":{"row":206,"column":35},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":35},"end":{"row":206,"column":36},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":36},"end":{"row":206,"column":37},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":37},"end":{"row":206,"column":38},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":38},"end":{"row":206,"column":39},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":39},"end":{"row":206,"column":40},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":40},"end":{"row":206,"column":41},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":41},"end":{"row":206,"column":42},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":42},"end":{"row":206,"column":43},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":43},"end":{"row":206,"column":44},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":44},"end":{"row":206,"column":45},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":45},"end":{"row":206,"column":46},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":46},"end":{"row":206,"column":47},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":47},"end":{"row":206,"column":48},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":48},"end":{"row":206,"column":49},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":49},"end":{"row":206,"column":50},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":50},"end":{"row":206,"column":51},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":51},"end":{"row":206,"column":52},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":52},"end":{"row":206,"column":53},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":53},"end":{"row":206,"column":54},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":54},"end":{"row":206,"column":55},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":55},"end":{"row":206,"column":56},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":56},"end":{"row":206,"column":57},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":57},"end":{"row":206,"column":58},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":58},"end":{"row":206,"column":59},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":59},"end":{"row":206,"column":60},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":60},"end":{"row":206,"column":61},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":61},"end":{"row":206,"column":62},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":62},"end":{"row":206,"column":63},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":63},"end":{"row":206,"column":64},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":206,"column":64},"end":{"row":206,"column":65},"action":"insert","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":22},"end":{"row":202,"column":29},"action":"remove","lines":["profile"]},{"start":{"row":202,"column":22},"end":{"row":202,"column":23},"action":"insert","lines":["A"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":23},"end":{"row":202,"column":24},"action":"insert","lines":["D"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":24},"end":{"row":202,"column":25},"action":"insert","lines":["M"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":25},"end":{"row":202,"column":26},"action":"insert","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":26},"end":{"row":202,"column":27},"action":"insert","lines":["N"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":27},"end":{"row":202,"column":28},"action":"insert","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":28},"end":{"row":202,"column":29},"action":"insert","lines":["S"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":28},"end":{"row":202,"column":29},"action":"remove","lines":["S"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":27},"end":{"row":202,"column":28},"action":"remove","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":26},"end":{"row":202,"column":27},"action":"remove","lines":["N"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":25},"end":{"row":202,"column":26},"action":"remove","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":24},"end":{"row":202,"column":25},"action":"remove","lines":["M"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":23},"end":{"row":202,"column":24},"action":"remove","lines":["D"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":22},"end":{"row":202,"column":23},"action":"remove","lines":["A"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":22},"end":{"row":202,"column":23},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":23},"end":{"row":202,"column":24},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":24},"end":{"row":202,"column":25},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":25},"end":{"row":202,"column":26},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":26},"end":{"row":202,"column":27},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":27},"end":{"row":202,"column":28},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":28},"end":{"row":202,"column":29},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":29},"end":{"row":202,"column":30},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":30},"end":{"row":202,"column":31},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":31},"end":{"row":202,"column":32},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":32},"end":{"row":202,"column":33},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":32},"end":{"row":202,"column":33},"action":"remove","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":32},"end":{"row":202,"column":33},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":33},"end":{"row":202,"column":34},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":34},"end":{"row":202,"column":35},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":202,"column":35},"end":{"row":202,"column":36},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":63,"column":4},"end":{"row":70,"column":4},"action":"insert","lines":["","\t","\t\tapp.get('/administracion', function(req, res) {","","\t\t// carga la página de inicio de sesión y muestra un mensaje en caso de error al registrarse","\t\tres.render('admin.ejs', { message: req.flash('loginMessage')});","\t\t","\t});"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":1},"end":{"row":70,"column":4},"action":"remove","lines":["\tapp.get('/administracion', function(req, res) {","","\t\t// carga la página de inicio de sesión y muestra un mensaje en caso de error al registrarse","\t\tres.render('admin.ejs', { message: req.flash('loginMessage')});","\t\t","\t});"]},{"start":{"row":80,"column":4},"end":{"row":90,"column":4},"action":"insert","lines":["","\t","\t\tapp.get('/profile', isLoggedIn, function(req, res) {","\t\t","\t\tres.render('profile.ejs', {","\t\t\tuser : req.user // get the user out of session and pass to template","\t\t});","\t\t","\t\tconsole.log(req.user.local.administrador);","\t","\t});"]}]}],[{"group":"doc","deltas":[{"start":{"row":82,"column":1},"end":{"row":82,"column":2},"action":"remove","lines":["\t"]},{"start":{"row":82,"column":11},"end":{"row":82,"column":18},"action":"remove","lines":["profile"]},{"start":{"row":82,"column":11},"end":{"row":82,"column":15},"action":"insert","lines":["admi"]}]}],[{"group":"doc","deltas":[{"start":{"row":82,"column":15},"end":{"row":82,"column":25},"action":"insert","lines":["nistracion"]},{"start":{"row":84,"column":14},"end":{"row":84,"column":21},"action":"remove","lines":["profile"]},{"start":{"row":84,"column":14},"end":{"row":84,"column":26},"action":"insert","lines":["administraci"]}]}],[{"group":"doc","deltas":[{"start":{"row":84,"column":26},"end":{"row":84,"column":28},"action":"insert","lines":["on"]}]}],[{"group":"doc","deltas":[{"start":{"row":86,"column":5},"end":{"row":87,"column":2},"action":"remove","lines":["","\t\t"]},{"start":{"row":87,"column":0},"end":{"row":88,"column":1},"action":"remove","lines":["\t\tconsole.log(req.user.local.administrador);","\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":85,"column":14},"end":{"row":85,"column":18},"action":"remove","lines":["user"]},{"start":{"row":85,"column":14},"end":{"row":85,"column":19},"action":"insert","lines":["admin"]}]}],[{"group":"doc","deltas":[{"start":{"row":85,"column":14},"end":{"row":85,"column":19},"action":"remove","lines":["admin"]},{"start":{"row":85,"column":14},"end":{"row":85,"column":18},"action":"insert","lines":["user"]}]}],[{"group":"doc","deltas":[{"start":{"row":85,"column":14},"end":{"row":85,"column":18},"action":"remove","lines":["user"]},{"start":{"row":85,"column":14},"end":{"row":85,"column":19},"action":"insert","lines":["admin"]}]}],[{"group":"doc","deltas":[{"start":{"row":85,"column":2},"end":{"row":85,"column":71},"action":"remove","lines":["\tuser : req.admin // get the user out of session and pass to template"]}]}],[{"group":"doc","deltas":[{"start":{"row":84,"column":33},"end":{"row":86,"column":3},"action":"remove","lines":[", {","\t\t","\t\t}"]}]}],[{"group":"doc","deltas":[{"start":{"row":83,"column":2},"end":{"row":83,"column":20},"action":"insert","lines":["console.log(\"kk\");"]}]}],[{"group":"doc","deltas":[{"start":{"row":82,"column":27},"end":{"row":82,"column":39},"action":"remove","lines":[" isLoggedIn,"]}]}],[{"group":"doc","deltas":[{"start":{"row":82,"column":27},"end":{"row":82,"column":39},"action":"insert","lines":[" isLoggedIn,"]}]}],[{"group":"doc","deltas":[{"start":{"row":83,"column":0},"end":{"row":84,"column":0},"action":"remove","lines":["\t\tconsole.log(\"kk\");",""]}]}],[{"group":"doc","deltas":[{"start":{"row":83,"column":35},"end":{"row":84,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":82,"column":27},"end":{"row":82,"column":40},"action":"remove","lines":[" isLoggedIn, "]},{"start":{"row":82,"column":27},"end":{"row":82,"column":28},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":82,"column":27},"end":{"row":82,"column":39},"action":"insert","lines":[" isLoggedIn,"]}]}],[{"group":"doc","deltas":[{"start":{"row":75,"column":70},"end":{"row":76,"column":0},"action":"remove","lines":["",""]},{"start":{"row":75,"column":70},"end":{"row":76,"column":0},"action":"insert","lines":["",""]},{"start":{"row":76,"column":5},"end":{"row":77,"column":2},"action":"remove","lines":["","\t\t"]},{"start":{"row":77,"column":0},"end":{"row":78,"column":1},"action":"remove","lines":["\t\tconsole.log(req.user.local.administrador);","\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":223,"column":0},"action":"remove","lines":["module.exports = function(app, passport) {","","\tvar Pintxo = require('../app/models/pintxo');//modelo","\tvar User = require('../app/models/user');//modelo","\tvar Bar = require('../app/models/bar');//modelo","","\t// =====================================","\t// INDEX ========","\t// =====================================","\tapp.get('/', function(req, res) {","\t\tres.render('index.ejs'); // Carga el index.ejs","\t\t","\t});","","\tapp.get('/pintxos', function (require, response) {","\t\t//Hacemos un find en la base de datos de la collección Pintxos","\t \tPintxo.find(function(err, pintxos) {","\t \t\t"," \t\t\tif (err) return console.error(err);"," \t\t\t//Obtenemos un array de pintxos (objetos json)","  \t\t\tresponse.send(pintxos);","  \t\t\t","\t\t});","\t\t","\t});","\t","\tapp.get('/bares', function (require, response) {","\t\t","\t \tBar.find(function(err, bares) {","\t \t\t"," \t\t\tif (err) return console.error(err);","  \t\t\tresponse.send(bares);","  \t\t\t","\t\t});","\t\t","\t});","\t","\t// =====================================","\t// LOGIN ===============================","\t// =====================================","\t// Muestra el formulario del login","\tapp.get('/login', function(req, res) {","","\t\t// carga la página de inicio de sesión y muestra un mensaje en caso de error al registrarse","\t\tres.render('login.ejs', { message: req.flash('loginMessage')});","\t\t","\t});","","\t// =====================================","\t// SIGNUP ==============================","\t// =====================================","\t// Muestra el formulario de registro","\tapp.get('/signup', function(req, res) {","\t\t// carga la página de registro y muestra un mensaje en caso de error al registrarse","\t\tres.render('signup.ejs', { message: req.flash('signupMessage')});","\t});","\t","\t// Muestra el formulario del login","\tapp.get('/admin', function(req, res) {","","\t\t// carga la página de inicio de sesión y muestra un mensaje en caso de error al registrarse","\t\tres.render('admin.ejs', { message: req.flash('loginMessage')});","\t\t","\t});","\t","\t","\t","\t// =====================================","\t// PROFILE SECTION =====================","\t// =====================================","\t// Para entrar en la sección de profile, hacemos que sea obligatorio estar logeado usando la función 'isLoggedIn'","\t// we will use route middleware to verify this (the isLoggedIn function)","\tapp.get('/profile', isLoggedIn, function(req, res) {","\t\t","\t\tres.render('profile.ejs', {","\t\t\tuser : req.user // get the user out of session and pass to template","\t\t});","","\t});","\t","\tapp.get('/administracion', isLoggedIn, function(req, res) {","\t\tres.render('administracion.ejs');","\t});","\t","\tapp.get('/edita-pintxos', isLoggedIn, function(req, res){","\t\t\t\t","\t\tPintxo.find({},function(err, pintxo){","\t\t\t//Si existe un error","\t\t\tif(err){","\t\t\t\t//Muestra por consola","\t\t\t\tconsole.log(err);","\t\t\t\tres.render('error');","\t\t\t}","\t\t\telse{","\t\t\t\t//Pasamos a la variable pintxos el pintxo","\t\t\t\tres.render('edita-pintxos.ejs', {","\t\t\t\t\tpintxos: pintxo","\t\t\t\t});","\t\t\t//Cierre de else","\t\t\t}","\t\t\t//Cierre del find","\t\t});","\t});","\t","\t//Añadir un pintxo a la colección de pintxos","\tapp.post('/edita-pintxos',  isLoggedIn, function(req, res) {","","\t\t//Creamos una variable para crear un objeto de tipo Pintxo","\t\tvar pintxo = new Pintxo ({","","\t\t\tnombre: req.body.nombre,","\t\t\tdescripcion: req.body.descripcion,","\t\t\timg: \"default\"//hasta que aprendamos a subir archivos se mantiene imagen por defecto","","\t\t});","","","\t\t//Para guardar dicha instancia en la base de datos","\t\tpintxo.save(function (err, pintxo) {","","\t\t  \t//Si existe un error","\t\t\tif(err){","\t\t\t\t","\t\t\t\t//Muestra por consola el error","\t\t    \tconsole.log('ERROR: ' + err);","\t\t    \t","\t\t\t}","\t\t\telse{","\t\t\t\t//Muestra el mensaje por consola","  \t\t\t\tconsole.log(pintxo.nombre + ' ha sido guardado.');","\t\t\t\tres.redirect('/edita-pintxos');","\t\t\t}","\t\t});","\t\t","\t});","\t","\t\t//Añadir un pintxo a la colección de pintxos","\tapp.post('/actualiza-pintxos',  isLoggedIn,function(req, res) {","\t\t","\t\tconsole.log(req.body.nombre);","\t\tconsole.log(req.body.descripcion);","\t\t","\t\tPintxo.update({_id: req.body._id}, {nombre: req.body.nombre, descripcion: req.body.descripcion}, null, function (err) {","","\t\t\t//Si hay error","\t\t\tif (err){","\t\t      \t//Muestra por consola el error","\t\t    \tconsole.log('ERROR: ' + err);","\t\t    }else{","\t\t    \t//redireccionamos a la página /edita-pintxos","\t\t\t\tres.redirect('/edita-pintxos')","\t\t    }","","\t\t//Cierre del método update","\t\t});","\t\t","\t//Cierre de la función","\t});","\t\t","","\t","\tapp.post('/borra-pintxos',  isLoggedIn,function(req, res){","\t\t","\t\tPintxo.findByIdAndRemove(req.body.id, function (err, users) {"," ","    \t\t\t//Si existe un error","\t\t\tif(err){","\t\t\t\t","\t\t\t\t//Muestra por consola el error","\t\t    \tconsole.log('ERROR: ' + err);","\t\t    \t","\t\t\t}","\t\t\telse{","\t\t\t\t//Muestra el mensaje por consola","  \t\t\t\tres.redirect('/edita-pintxos');","\t\t\t}"," ","  \t\t});","","\t});","","\t// =====================================","\t// LOGOUT ==============================","\t// =====================================","\tapp.get('/logout', function(req, res) {","\t\treq.logout();","\t\tres.redirect('/');","\t});","","\t// procesamos el formulario de registro","\tapp.post('/signup', passport.authenticate('local-signup', {","\t\tsuccessRedirect : '/profile', // redirect to the secure profile section","\t\tfailureRedirect : '/signup', // redirect back to the signup page if there is an error","\t\tfailureFlash : true // allow flash messages","\t}));","","\t// procesamos el formulario login","\tapp.post('/login', passport.authenticate('local-login', {","\t\tsuccessRedirect : '/profile', // redirect to the secure profile section","\t\tfailureRedirect : '/login', // redirect back to the signup page if there is an error","\t\tfailureFlash : true // allow flash messages","\t}));","\t","\t//////////BORRAR SI NO FUNCIONA PARA NADA////////////////////////","\t// procesamos el formulario login","\tapp.post('/admin', passport.authenticate('local-admin', {","\t\tsuccessRedirect : '/administracion', // redirect to the secure profile section","\t\tfailureRedirect : '/admin', // redirect back to the signup page if there is an error","\t\tfailureFlash : true // allow flash messages","\t}));","\t////////////////////////////////////////////////////////////////","};","","// esta es la función utilizada para verificar que un usuario está autentificado","function isLoggedIn(req, res, next) {","","\t// Si el usuario está autentificado, sigue adelante ","\tif (req.isAuthenticated())","\t\treturn next();","","\t// si no ha accedido, redirecciona al inicio","\tres.redirect('/');","}",""]}]}]]},"ace":{"folds":[],"customSyntax":"javascript","scrolltop":2919,"scrollleft":0,"selection":{"start":{"row":0,"column":0},"end":{"row":223,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1420630623684,"hash":"8b871cf33b580a7972ea5e685829915e68dc65f9"}